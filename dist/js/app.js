var CLIENT_ID="4GNROS1TSIOHBJUREG4XHZJ4XEW5PSDQTQQHE1QJS4K2RNPU",CLIENT_SECRET="RKNZD0L1UVXDXRC1QFWBGC4F3UI4KAYUSWJGN5XRMF3X4AWR",initialHotSpots=[{name:"Maggiano's",lat:39.216329,lng:-76.860202,street:"10300 Little Patuxent Parkway",city:"Columbia",state:"MD",phone:"(410) 730-3706",website:"http://locations.maggianos.com/us/maryland/columbia/the-mall-in-columbia/"},{name:"Panera Bread",lat:39.195841,lng:-76.821001,street:"6435 Dobbin Rd",city:"Columbia",state:"MD",phone:"(410) 772-8632",website:"https://www.panerabread.com/en-us/home.html"},{name:"Chipotle",lat:39.200559,lng:-76.812119,street:"6181 Old Dobbin Ln",city:"Columbia",state:"MD",phone:"(410) 872-8688",website:"http://www.chipotle.com/en-US/default.aspx?type=default"},{name:"Mission BBQ",lat:39.199195,lng:-76.813579,street:"6270 Columbia Crossing Cir",city:"Columbia",state:"MD",phone:"(443) 832-6180",website:"http://mission-bbq.com/"},{name:"UA Snowden Square Stadium 14",lat:39.177644,lng:-76.819536,street:"9161 Commerce Center Drive",city:"Columbia",state:"MD",phone:"(844) 462-7342",website:"http://www.regmovies.com/theatres/theatre-folder/UA-Snowden-Square-Stadium-14-2486?utm_source=maps&utm_medium=organic&utm_campaign=United_Artists_Snowden_Square_Stadium_14_Movie_Theater"},{name:"Zapata’s Restaurant",lat:39.22332,lng:-76.889508,street:"5485 Harpers Farm Rd",city:"Columbia",state:"MD",phone:"(410) 715-6929",website:"http://www.zapatasonline.com/"},{name:"Tino’s Italian Bistro",lat:39.226832,lng:-76.817999,street:"8775 Centre Park Dr",city:"Columbia",state:"MD",phone:"(410) 730-8466",website:"http://www.tinositalianbistro.com/"},{name:"Wegmans Columbia",lat:39.186425,lng:-76.820281,street:"8855 Mcgaw Rd",city:"Columbia",state:"MD",phone:"(443) 537-2900",website:"http://www.wegmans.com/webapp/wcs/stores/servlet/StoreDetailView?langId=-1&storeId=10052&catalogId=10002&productId=738282"}],hotSpot=function(t){this.name=ko.observable(t.name),this.lat=ko.observable(t.lat),this.lng=ko.observable(t.lng),this.street=ko.observable(t.street),this.city=ko.observable(t.city),this.state=ko.observable(t.state),this.address=ko.computed(function(){return this.street()+", "+this.city()+"MD"},this),this.phone=ko.observable(t.phone),this.website=ko.observable(t.website),this.marker=ko.observable({}),this.rating=ko.observable({}),this.img=ko.computed(function(){return"https://maps.googleapis.com/maps/api/streetview?size=200x200&location="+this.address()},this)},ViewModel=function(){function t(t,o){google.maps.event.addListener(t,"click",function(t,o){return function(){p=e.hotSpotList()[o].img(),l="<h1>"+e.hotSpotList()[o].name()+"</h1><br><p>"+e.hotSpotList()[o].street()+"<br>"+e.hotSpotList()[o].city()+", "+e.hotSpotList()[a].state()+"<br>"+e.hotSpotList()[o].phone()+"<br><a href='"+e.hotSpotList()[o].website()+"'>website</a></p><br><p>foursquare rating:"+e.hotSpotList()[o].rating()+"</span></p>",r.setContent(l),r.open(n,t)}}(t,o))}$("#list").hide(),$("#MapNav").addClass("active");var e=this;this.mapRoute=function(){$("#MapNav").addClass("active"),$("#ListNav").removeClass("active"),$("#list").hide(),$("#map").show()},this.listRoute=function(){$("#ListNav").addClass("active"),$("#MapNav").removeClass("active"),$("#map").hide(),$("#list").show()},this.hotSpotList=ko.observableArray([]),initialHotSpots.forEach(function(t){e.hotSpotList.push(new hotSpot(t))}),this.filter=ko.observable("");var o=!1;this.resetMarkers=function(){for(a=0;a<e.hotSpotList().length;a++)e.hotSpotList()[a].marker.setVisible(!0)};var s,a,i={center:new google.maps.LatLng(39.203714,-76.861046),zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP},n=new google.maps.Map(document.getElementById("map"),i),r=new google.maps.InfoWindow,l="",p="";for(a=0;a<e.hotSpotList().length;a++)s=new google.maps.Marker({position:new google.maps.LatLng(e.hotSpotList()[a].lat(),e.hotSpotList()[a].lng()),map:n}),e.hotSpotList()[a].marker=s,$.ajax({url:"https://api.foursquare.com/v2/venues/explore",dataType:"json",data:"limit=1&ll="+e.hotSpotList()[a].lat()+","+e.hotSpotList()[a].lng()+"&query="+e.hotSpotList()[a].name()+"&client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRET+"&v=20140806&m=foursquare",async:!0,hotspot:e.hotSpotList()[a],mark:s,success:function(e){this.hotspot.rating=e.response.groups[0].items[0].venue.rating;var o="#rating"+a;$(o).text(this.hotspot.rating),console.log(this.hotspot.rating),t(this.mark,a)}});this.searchLocation=ko.computed(function(){var t=this.filter().toLowerCase();return t?(this.resetMarkers(),ko.utils.arrayFilter(this.hotSpotList(),function(e){return o=-1!=e.name().toLowerCase().indexOf(t),o||e.marker.setVisible(!1),o})):(this.resetMarkers(),this.hotSpotList())},this)};ko.applyBindings(new ViewModel);